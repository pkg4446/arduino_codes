# 영천 스마트벌통 펌웨어

1. Built in led

1~3번 LED는 1초에 한번씩 300밀리초 동안 켜짐.
1번. 와이파이가 연결되었을 경우.
2번. 메뉴얼모드<수동>을 켤 경우.
3번. 자동 가온기능을 켤 경우.

4번 LED는 가온기능이 켜졌을 때, 1초에 한번씩 켜지며, 켜지는 시간은 전기가 인가된 가온판 갯수*200밀리초.
ex> 전기가 인가된 가온판 0개, 불이 켜지지 않음.
ex> 전기가 인가된 가온판 3개, 1초에 한번씩 600밀리초 동안 켜짐.
ex> 전기가 인가된 가온판 5개, 불이 계속 켜져있음.


2. Serial commend

Serial 접속 상태에서 엔터키를 누르면, Help 메뉴가 나옴.
Help 메뉴에 대한 설명.

2.01. reboot: 보드 재부팅다. 보드에 부착된 리셋 버튼을 누른것과 동일함.
2.02. temp: sht3x의 온습도와 k-type 열전대의 온도 표시.

2.03. run: run on 을 입력할 경우 자동 가온기능이 켜지며, set 명령어로 설정한 온도까지 가온을 함. 
run on 이 아닌, 
run, 
run off 등 명령어를 입력할 경우 자동 가온기능이 꺼짐.

2.04. set: set <번호 0~5> <온도> 를 입력할 경우 해당 번호의 벌통 가온 목표온도를 수정 할 수 있음. 
벌통 번호는 0부터 4 까지 이며, 5번을 선택할 경우, 전체 벌통의 목표온도를 한번에 설정함. 
ex> set 0 25: 0번 벌통 목표온도 25도로 설정. 
ex> set 5 15: 0~4번 벌통의 목표온도를 15도로 설정.

2.05. config: 0~4번 벌통의 목표온도 표시.
2.06. gap: 센서 업로드 주기 변경<단위 분>. ex>gap 5

2.07. test: test mode 를 입력할 경우 메뉴얼 모드로 변경되며,
메뉴얼 모드에서 test on, test off 명령어로 MOSFET을 수동으로 켜고 끌 수 있음. 
주의사항: 메뉴얼 모드로 변경할 경우 에서는 자동 가온 기능이 작동하지 않음. 메뉴얼 모드를 종료하는 방법은 test 만 입력하거나, 재부팅을 하면 됨. (test data 추가: 데이터 서버로 전송)

2.08. time: DS3231 rtc모듈의 시간을 표시.
2.09. timeset: wifi로 인터넷에 연결되어 있어야 작동하며, 구글에 접속하여 인터넷 시간으로 시계를 갱신함.

2.10. ssid: ssid 를 입력함. 2G만 연결가능. ex> ssid avatar2G
2.11. pass: password 를 입력함. ex> pass q1w2e3r4

2.12. wifi: wifi 만 입력할 경우 설정된 2.09, 2.10 에서 설정한 ssid와 password로 wifi에 접속을 시도함.
wifi scan 을 입력할 경우 주변에 있는 ssid를 검색함.
wifi stop을 입력할 경우 wifi 접속을 종료함.

#update
2024.12.04: 최초 코드 완성
2025.02.24: 봉구온도가 34도 이상일 경우 가온중지, 봉구센서 에러일 경우는 무시, line_174